<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="Rotate PDF pages: fix orientation 90, 180, or 270. Free online tool  rotate all or select pages, browser-based, no uploads." />
    <title>Rotate PDF - EDITSMYPDF</title>
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="../assets/styles.css" />
    <link rel="canonical" href="https://editmypdf.tech/features/rotate.html" />  <link rel="icon" type="image/png" href="../assets/images/sflogoPNG.PNG" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.16.105/pdf.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.16.105/pdf.worker.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf-lib/1.17.1/pdf-lib.min.js"></script>
    <style>
      * {
        box-sizing: border-box;
      }

      body {
        font-family: "Inter", sans-serif;
        margin: 0;
        background: #fff;
        color: #111;
      }
      main {
        max-width: 760px;
        margin: 3rem auto;
        padding: 1rem;
        text-align: center;
      }
      h2 {
        font-size: 2rem;
        margin: 0.5rem 0 1rem;
      }
      p.sub {
        color: #555;
        margin-top: 0;
      }
      .card {
        border: 1px solid #eee;
        border-radius: 16px;
        padding: 2rem;
        box-shadow: 0 2px 6px rgba(0, 0, 0, 0.05);
        text-align: left;
      }
      .upload-box {
        border: 2px dashed #ccc;
        border-radius: 12px;
        padding: 2rem;
        cursor: pointer;
        transition: 0.25s;
        text-align: center;
      }
      .upload-box:hover {
        background: #f8faff;
      }
      .upload-box.dragover {
        border-color: #e53935;
        background: #fff;
      }
      label,
      input,
      select,
      button {
        display: block;
        margin: 0.75rem auto;
        font-size: 1rem;
      }
      input[type="text"] {
        border: 1px solid #ddd;
        border-radius: 8px;
        padding: 0.6rem 0.9rem;
        width: 240px;
      }
      select {
        border: 1px solid #ddd;
        border-radius: 8px;
        padding: 0.6rem 0.9rem;
        width: 240px;
      }
      button {
        background: linear-gradient(90deg, #e53935, #c62828);
        color: #fff;
        border: none;
        border-radius: 10px;
        padding: 0.85rem 1.6rem;
        font-weight: 600;
        cursor: pointer;
        transition: 0.3s;
      }
      button:hover {
        opacity: 0.9;
      }
      .file-info {
        margin-top: 0.5rem;
        color: #333;
        font-weight: 500;
        font-size: 0.95rem;
      }
      .pages-preview {
        display: flex;
        flex-wrap: wrap;
        gap: 0.75rem;
        margin-top: 1rem;
      }
      .page-thumb {
        position: relative;
        width: 110px;
        height: 140px;
        background: #fafafa;
        border: 1px solid #ddd;
        border-radius: 8px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 0.9rem;
        font-weight: 600;
        color: #555;
        cursor: pointer;
        transition: 0.25s;
        overflow: hidden;
      }
      .page-thumb:hover {
        background: #ffe5e5;
        border-color: #e53935;
      }
      .page-thumb.active {
        outline: 2px solid #e53935;
        outline-offset: 2px;
        background: #fff;
      }
      .page-thumb canvas {
        max-width: 100%;
        max-height: 100%;
        transition: transform 0.2s ease;
      }
      .thumb-tools {
        position: absolute;
        left: 4px;
        right: 4px;
        bottom: 4px;
        display: flex;
        gap: 4px;
        justify-content: center;
      }
      .thumb-tools button {
        background: rgba(17, 17, 17, 0.8);
        color: #fff;
        border: 1px solid rgba(255, 255, 255, 0.25);
        padding: 4px 6px;
        border-radius: 8px;
        font-size: 0.8rem;
      }
      .thumb-tools button:hover {
        background: rgba(17, 17, 17, 0.95);
      }
      .actions-row {
        display: flex;
        flex-wrap: wrap;
        gap: 0.75rem;
        justify-content: center;
        margin-top: 1rem;
      }
      .actions-row button {
        flex: 1 1 140px;
      }
      .progress {
        margin-top: 1rem;
        min-height: 1.3rem;
        color: #555;
        text-align: center;
      }
      .ad-box {
        margin-top: 3rem;
        height: 90px;
        background: #f5f5f5;
        border: 1px solid #ddd;
        border-radius: 8px;
        display: flex;
        align-items: center;
        justify-content: center;
        color: #999;
        font-weight: 500;
      }

      /* Enhanced Feature Blog Styles */
      .feature-blog {
        max-width: 700px;
        margin: 3rem auto 0;
        padding: 2rem;
        background: linear-gradient(135deg, #f8faff 0%, #f0f4ff 100%);
        border-left: 5px solid #2563eb;
        border-radius: 16px;
        box-shadow: 0 4px 16px rgba(37, 99, 235, 0.08);
        font-family: "Inter", -apple-system, BlinkMacSystemFont, sans-serif;
        line-height: 1.7;
        color: #475569;
      }
      .feature-blog h3 {
        font-size: 1.85rem;
        font-weight: 700;
        color: #1e40af;
        margin: 0 0 1rem;
        line-height: 1.3;
      }
      .feature-blog h4 {
        font-size: 1.35rem;
        font-weight: 600;
        color: #1e40af;
        margin: 2rem 0 0.75rem;
        line-height: 1.4;
      }
      .feature-blog p {
        margin: 0 0 1.25rem;
        font-size: 1.05rem;
      }
      .feature-blog strong {
        color: #334155;
        font-weight: 600;
      }
      .feature-blog ul,
      .feature-blog ol {
        margin: 0 0 1.5rem;
        padding-left: 1.5rem;
      }
      .feature-blog li {
        margin-bottom: 0.75rem;
        font-size: 1.02rem;
      }
      .feature-blog code {
        background: #e0e7ff;
        color: #4338ca;
        padding: 0.2rem 0.5rem;
        border-radius: 6px;
        font-family: "Consolas", "Monaco", monospace;
        font-size: 0.92rem;
      }
      .feature-blog .hero-img {
        width: 100%;
        max-width: 100%;
        height: auto;
        border-radius: 12px;
        margin: 1.5rem 0;
        box-shadow: 0 6px 20px rgba(37, 99, 235, 0.12);
        border: 1px solid #e0e7ff;
      }
      .feature-blog .tip {
        background: #eff6ff;
        border-left: 4px solid #3b82f6;
        border-radius: 10px;
        padding: 1.25rem;
        margin: 1.5rem 0;
        font-size: 1rem;
      }
      .feature-blog .tip strong {
        color: #1e40af;
        display: block;
        margin-bottom: 0.5rem;
      }
      .feature-blog .note {
        background: #fefce8;
        border-left: 4px solid #eab308;
        border-radius: 10px;
        padding: 1.25rem;
        margin: 2rem 0 0;
        font-size: 1.05rem;
        color: #713f12;
      }
      .feature-blog .note a {
        color: #2563eb;
        font-weight: 600;
        text-decoration: none;
        border-bottom: 2px solid transparent;
        transition: border-color 0.2s;
      }
      .feature-blog .note a:hover {
        border-bottom-color: #2563eb;
      }
      .feature-blog details {
        background: #ffffff;
        border: 1px solid #e0e7ff;
        border-radius: 12px;
        padding: 1rem 1.25rem;
        margin-bottom: 1rem;
        box-shadow: 0 2px 8px rgba(37, 99, 235, 0.06);
        transition: all 0.3s ease;
      }
      .feature-blog details:hover {
        box-shadow: 0 4px 12px rgba(37, 99, 235, 0.12);
      }
      .feature-blog details[open] {
        background: #f8faff;
        border-color: #3b82f6;
      }
      .feature-blog summary {
        font-weight: 600;
        color: #1e40af;
        cursor: pointer;
        font-size: 1.08rem;
        padding: 0.5rem 0;
        list-style: none;
        display: flex;
        align-items: center;
        gap: 0.75rem;
      }
      .feature-blog summary::-webkit-details-marker {
        display: none;
      }
      .feature-blog summary::before {
        content: "â–¶";
        color: #3b82f6;
        font-size: 0.85rem;
        transition: transform 0.3s;
        flex-shrink: 0;
      }
      .feature-blog details[open] summary::before {
        transform: rotate(90deg);
      }
      .feature-blog details p {
        margin-top: 0.75rem;
        padding-left: 1.5rem;
        color: #64748b;
        font-size: 1rem;
      }
      @media (max-width: 640px) {
        .feature-blog {
          padding: 1.5rem;
          margin: 2rem 0.5rem 0;
        }
        .feature-blog h3 {
          font-size: 1.5rem;
        }
        .feature-blog h4 {
          font-size: 1.15rem;
        }
        .feature-blog p,
        .feature-blog li {
          font-size: 0.98rem;
        }
      }
    </style>
  </head>
  <body>
    <header data-include="navbar"></header>
    <div id="ad-top" class="ad-slot"></div>
    <main class="feature">
      <h2>Rotate PDF</h2>
      <p class="sub">
        Upload a PDF, select pages, then rotate clockwise or counter-clockwise.
        All process is done locally on the device
      </p>
      <div class="card">
        <label class="upload-box" id="drop-zone"
          >ðŸ“„ Drop your PDF here or click to upload
          <input
            type="file"
            id="file-input"
            accept="application/pdf"
            style="display: none"
          />
        </label>
        <div id="file-info" class="file-info"></div>
        <div class="pages-preview" id="pages"></div>
        <div class="actions-row">
          <button
            id="rotate-left"
            disabled
            title="Rotate selected pages 90Â° counter-clockwise"
          >
            âŸ² 90Â° Left
          </button>
          <button
            id="rotate-right"
            disabled
            title="Rotate selected pages 90Â° clockwise"
          >
            âŸ³ 90Â° Right
          </button>
          <button id="rotate-180" disabled title="Rotate selected pages 180Â°">
            â‡µ 180Â°
          </button>
        </div>
        <label for="output-name">Output filename</label>
        <input
          type="text"
          id="output-name"
          value="rotated"
          placeholder="e.g., rotated"
        />
        <button id="download-btn" style="display: none">
          Download Rotated PDF
        </button>
        <div id="status" class="progress"></div>
      </div>
      <div id="ad-content" class="ad-slot"></div>

      <!-- Enhanced Feature Blog Section -->
      <section class="feature-blog" aria-labelledby="rotate-guide-title">
        <div class="title-with-logo">
          <img src="../assets/images/sflogoPNG.PNG" alt="PDF Tools Logo" class="brand-logo" />
          <h3 id="rotate-guide-title">
            Rotate PDF Pages Fix Orientation Instantly using this tool
          </h3>
        </div>

        <p>
          <strong>Pages sometimes end up sideways or upside down ?</strong>
          The Rotate tool allows selection of particular pages. It rotates them ninety degrees left, ninety degrees right, or one hundred eighty degrees. This fixes any orientation problems
          <strong>Everything processes right in the browser.</strong>, keeping your documents
          private and secure.
        </p>

        <img
          src="../assets/images/rotate pdff - Copy.JPG"
          alt="Rotate PDF pages to fix orientation"
          class="hero-img"
        />

        <h4>How it excute</h4>
        <p>
         The Rotate tool pulls in PDF.js for showing those page thumbnails. That way, you get a clear look at the current setup of each page. Then it switches over to pdf-lib for actually turning the selected pages the way you want.
          <strong>Everything runs right there in the browser with JavaScript handling it all.</strong> No need to send files to any server. Nothing gets collected on your data either. You just pick out the pages, decide on the direction to rotate, and grab the fixed PDF when its done.
        </p>

        <p>
          Imagine flipping through a physical book and adjusting each page so it sits right. Scanners along with apps on phones usually spit out PDF files that have pages all jumbled in direction. You get some turned sideways. Others come out upside down. This particular tool takes care of the whole batch right away.
        </p>

        <h4>Why to Use This Tool</h4>
        <ul>
          <li>
            <strong>Fix the Scanned documents </strong> - Correct orientation from
            scanner or multi-function printer outputs
          </li>
          <li>
            <strong>Mobile photo PDFs</strong> - Rotate pages captured on phones
            or tablets with inconsistent orientation
          </li>
          <li>
            <strong>Mixed-orientation files</strong> - Standardize documents
            with portrait and landscape pages
          </li>
          <li>
            <strong>Printing preparation</strong> - Ensure all pages print
            correctly without manual adjustment
          </li>
          <li>
            <strong>Reading comfort</strong> - Make PDFs readable without
            tilting your screen or head
          </li>
        </ul>

        <h4>Complete Privacy</h4>
        <p>
          The PDF file stays entirely on the user's own computer throughout the process. Rotation of individual pages takes place right there in the browser itself. This relies on tools like PDF.js and pdf-lib to handle everything locally. Files never get sent over to any kind of server at all. Evidence from similar systems shows this setup matters a great deal for privacy. It helps especially with confidential items such as contracts or medical records. Legal documents and personal IDs fall into that category too. Studies on data handling indicate these protections could prevent unnecessary risks in sensitive situations.
        </p>

        <div class="tip">
          <strong> Your Privacy Matters:</strong><br />
          100% client-side processing - everything stays on your device<br />
          No server uploads - your document never goes online<br />
          No data logging - we never see your file contents<br />
          Works offline - rotate PDFs even without internet connection
        </div>

        <h4>Rotation Options</h4>
        <ul>
          <li>
            <strong> 90 Left (Counter-clockwise):</strong> Rotates pages 90
            degrees to the leftuseful for landscape pages that should be
            portrait
          </li>
          <li>
            <strong> 90 Right (Clockwise):</strong> Rotates pages 90 degrees to
            the rightfixes portrait pages that are sideways
          </li>
          <li>
            <strong> 180 Flip:</strong> Flips pages upside-downcorrects
            documents scanned backward
          </li>
          <li>
            <strong>Select multiple pages:</strong> Click thumbnails to select,
            then apply rotation to all selected pages at once
          </li>
          <li>
            <strong>Preview before download:</strong> See rotation changes in
            real-time in the thumbnail preview
          </li>
        </ul>

        <h4>Rotation Tips</h4>
        <ul>
          <li>
            <strong>Preview thumbnails:</strong> The tool shows page previews so
            you can see which pages need rotation
          </li>
          <li>
            <strong>Select strategically:</strong> Click multiple page
            thumbnails, then rotate them all at once
          </li>
          <li>
            <strong>Multiple rotations:</strong> You can rotate pages, then
            rotate again if needed before downloading
          </li>
          <li>
            <strong>Keep originals:</strong> This tool creates a new file; your
            original PDF remains unchanged
          </li>
          <li>
            <strong>Batch processing:</strong> Rotate all landscape pages
            together by selecting them all first
          </li>
          <li>
            <strong>Name outputs clearly:</strong> Use descriptive filenames
            like "contract-rotated" for organization
          </li>
        <h4>Rotation Tips</h4>
        <p>Rotating PDF pages is straightforward, but a few smart moves will save you from having to redo corrections. Here's what you need to know:</p>
        <ul>
          <li>
            <strong>Select Multiple Pages for Batch Rotation:</strong>Rather than going through and rotating each page individually, you can select several thumbnails at the same time. They will light up to show they are chosen. After that, just press the rotation button. It will turn all those picked pages together in one go. That method saves a lot of time, especially for files where pages keep flipping the wrong way every second one.
          </li>
          <li>
            <strong>Preview Changes Before Downloading:</strong> Once you finish rotating the pages. The thumbnails change right away. They show the updated direction each one faces. You can scroll through the whole set. Take a good look at everything. Confirm it all appears just right. Do this before you click on download rotated PDF. Fixing any errors at this point saves a lot of hassle. It beats the pain of reuploading files and starting the process over again.
          </li>
          <li>
            <strong>Left vs. Right Can Be Confusing:</strong> If you find yourself unsure about the rotation direction, picture it as flipping over an actual page from a book. Turning ninety degrees to the right means going clockwise. That adjustment positions portrait-style pages so they face toward the right. Especially if those pages started out upside down from the left side. Ninety degrees to the left goes the other way around. Counter clockwise in other words. It reverses what the right turn does. Still not clear on it. Just go ahead and test one option. The thumbnail view refreshes right away. You will spot immediately if your choice worked out.
          </li>
          <li>
            <strong>180Â° for Upside-Down Scans:</strong> When pages show up completely upside down, with the text itself reading just fine but the whole thing flipped around, hit that 180 degree rotation button. That kind of mix up happens pretty often. It comes from feeding documents backward into the scanner. A single click gets everything right side up again. It leaves the portrait or landscape setup alone.
          </li>
          <li>
            <strong>Large Files Take Longer:</strong>When dealing with a 200 page PDF and trying to rotate it, rendering all the thumbnails really takes some time. It can last 30 to 60 seconds in many cases. Just stay patient. Allow the page to load up fully before beginning any clicks. Going ahead with rotations while thumbnails keep rendering often leads to lag problems. Selections can get missed along the way.
          </li>
          <li>
            <strong>Mixed Orientation? That's Normal:</strong> 
            Some documents often include pages in both portrait and landscape orientations. Reports, for instance, might feature standard text on one page and broad charts on another that require extra width. There is no need to rotate every page just to achieve uniformity. Instead, correct only those pages that show clear errors in orientation. A combination of orientations works well when it suits the material presented.
          </li>
        </ul>

        <h4>ðŸ”„ Common Rotation Scenarios</h4>
        <p>Not sure which rotation you need? Here are the most common situations and how to fix them:</p>
        <p><strong>Scanned Documents with Mixed Orientation:</strong> Scanners tend to produce PDFs with pages turned sideways at ninety degrees or even upside down at one hundred eighty degrees. This happens based on the way the paper gets loaded into the machine. People usually spot the sideways ones first. They grab all those pages together. Then they turn them ninety degrees the right way around. After that comes the upside down batch. Select those next. Flip them one hundred eighty degrees with a quick command. Handle it in just two groups like this. The whole thing wraps up pretty fast.</p>
        <p><strong>Mobile Photo PDFs:</strong> People snap photos on their phones all the time. Then they convert those images into PDF files for whatever reason. The orientation of each picture in that PDF comes down to the way the phone was held during the shot. Sometimes a few shots end up rotated sideways by mistake. In those cases, users can simply select the affected images. Then rotate them ninety degrees either left or right until everything stands upright. The small thumbnail previews in the software make it easy to see exactly which direction works best.</p>
        <p><strong>Landscape Pages in Portrait Documents:</strong> Documents often come in portrait orientation most of the time. Sometimes there are a few wide charts or tables that fit better in landscape. Those do not require rotation at all. They sit sideways on purpose. Just handle the pages where something went wrong. Text meant to read straight across ends up tilted instead. That calls for fixing.</p>
        <p><strong>Printing Preparation:</strong> When you plan to print out a large PDF file, it helps to rotate any pages that need it first. This ensures everything appears right side up on the final output. Printers generally lack the ability to auto rotate content on their own. As a result, if page five shows up sideways within the PDF, that same orientation carries over to the printed sheet. Taking care of the adjustment digitally ahead of time prevents unnecessary waste of paper and toner supplies.</p>

        <h4>Quick Guide</h4>
        <ol>
          <li>
            <strong>Upload your PDF:</strong> Click or drag your file into the
            upload area
          </li>
          <li>
            <strong>Preview pages:</strong> Wait for thumbnails to load showing
            current orientation
          </li>
          <li>
            <strong>Select pages:</strong> Click on page thumbnails you want to
            rotate (they'll highlight)
          </li>
          <li>
            <strong>Choose rotation:</strong> Click 90 Left, 90 Right, or 180
            button
          </li>
          <li>
            <strong>Set output name:</strong> Enter a descriptive filename for
            your rotated PDF
          </li>
          <li>
            <strong>Download:</strong> Click the download button to save your
            corrected PDF!
          </li>
        </ol>

        <h4>Frequently Asked Questions</h4>
        <details>
          <summary>
            Can I rotate different pages in different directions?
          </summary>
          <p>
          Users can pick out a group of pages from the document. They rotate those pages in one direction to get the orientation right. Next, they select some other pages that need adjusting. Those get rotated in a different way, maybe the opposite direction. It works well to do this several times over. That way, everything lines up before the final step. Then, downloading the completed PDF becomes straightforward.
          </p>
        </details>

        <details>
          <summary>Does rotating reduce image quality?</summary>
          <p>
            No, PDF rotation does not involve any real alteration to the document's content. It functions as a straightforward metadata operation, one that merely adjusts the orientation flag associated with each individual page. Elements such as text passages, embedded images, and vector elements stay entirely intact through this process. Quality remains preserved without any degradation whatsoever. This approach proves especially practical in fields like document archiving, where maintaining original fidelity matters a great deal for long term storage and retrieval.
          </p>
        </details>

        <details>
          <summary>What if I rotate a page the wrong direction?</summary>
          <p>
            Just rotate it again! You can rotate the same page multiple times.
            For example, if you rotate 90 right but meant to go left, just
            rotate that page 90 left twice (or 180 once, then 90 left).
          </p>
        </details>

        <details>
          <summary>Can I rotate all pages at once?</summary>
          <p>
            Yes. Click on all page thumbnails to select them (or use Ctrl+A if
            your browser supports selecting all), then click your desired
            rotation button. All selected pages will rotate together.
          </p>
        </details>

        <details>
          <summary>Why are my thumbnails taking long to load?</summary>
          <p>
            Large PDFs with many pages or high-resolution images take longer to
            render thumbnails. PDF.js renders each page in your browser. For 50+
            page documents, expect 10-30 seconds of processing time.
          </p>
        </details>

        <details>
          <summary>What happens to my original PDF?</summary>
          <p>
           Your original file stays exactly the same on your device. No changes happen to it at all. The rotate tool goes ahead and generates a fresh PDF. That new file includes all the rotation adjustments you made. In the end, both versions sit there for you. The unchanged original and the updated rotated one.
          </p>
        </details>

        <div class="note">
          Ready to fix your PDF orientation? Upload your file, select pages,
          rotate them to the correct position, and download in seconds.
          <a href="#file-input">Try it now </a>
        </div>
      </section>
    </main>
    <div id="ad-footer" class="ad-slot"></div>
    <div data-include="footer"></div>

    <script>
      const pdfjsLib = window["pdfjs-dist/build/pdf"] || window.pdfjsLib;
      if (pdfjsLib && pdfjsLib.GlobalWorkerOptions) {
        pdfjsLib.GlobalWorkerOptions.workerSrc =
          "https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.16.105/pdf.worker.min.js";
      }

      const fileInput = document.getElementById("file-input");
      const dropZone = document.getElementById("drop-zone");
      const pagesWrap = document.getElementById("pages");
      const statusText = document.getElementById("status");
      const rotateLeftBtn = document.getElementById("rotate-left");
      const rotateRightBtn = document.getElementById("rotate-right");
      const rotate180Btn = document.getElementById("rotate-180");
      const downloadBtn = document.getElementById("download-btn");
      let originalBytes = null;
      let loadedDoc = null;
      let selected = new Set();
      let outBlob = null;
      let rotations = []; // per-page rotation in degrees (0/90/180/270)
      let thumbCanvases = []; // per-page thumbnail canvas for live preview

      dropZone.addEventListener("dragover", (e) => {
        e.preventDefault();
        dropZone.classList.add("dragover");
      });
      dropZone.addEventListener("dragleave", () =>
        dropZone.classList.remove("dragover")
      );
      dropZone.addEventListener("drop", async (e) => {
        e.preventDefault();
        dropZone.classList.remove("dragover");
        const f = e.dataTransfer.files[0];
        if (f) await loadFile(f);
      });
      fileInput.addEventListener("change", async (e) => {
        const f = e.target.files[0];
        if (f) await loadFile(f);
        e.target.value = "";
      });

      function enableActions() {
        // Enable rotate buttons once a PDF is loaded. If no pages are selected,
        // clicking a rotate button will apply to ALL pages (handled below).
        const hasDoc = !!loadedDoc && loadedDoc.getPageCount() > 0;
        rotateLeftBtn.disabled = !hasDoc;
        rotateRightBtn.disabled = !hasDoc;
        rotate180Btn.disabled = !hasDoc;
      }
      function clearOutput() {
        downloadBtn.style.display = "none";
        outBlob = null;
      }

      async function loadFile(file) {
        clearOutput();
        statusText.textContent = "Reading PDF...";
        try {
          originalBytes = new Uint8Array(await file.arrayBuffer());
          loadedDoc = await PDFLib.PDFDocument.load(originalBytes, {
            ignoreEncryption: true,
          });
          const pageCount = loadedDoc.getPageCount();
          pagesWrap.innerHTML = "";
          selected.clear();
          enableActions();
          rotations = new Array(pageCount).fill(0);
          thumbCanvases = new Array(pageCount).fill(null);

          // Render thumbnails with pdf.js so user can see pages
          const task = pdfjsLib.getDocument({ data: originalBytes });
          const pdf = await task.promise;
          for (let i = 0; i < pageCount; i++) {
            const div = document.createElement("div");
            div.className = "page-thumb";
            div.dataset.index = i;

            // Canvas preview
            const canvas = document.createElement("canvas");
            canvas.style.pointerEvents = "none";
            div.appendChild(canvas);

            // Per-thumb rotate controls
            const tools = document.createElement("div");
            tools.className = "thumb-tools";
            tools.innerHTML =
              '<button data-act="l" title="Rotate 90Â° left">âŸ²</button><button data-act="r" title="Rotate 90Â° right">âŸ³</button><button data-act="u" title="Rotate 180Â°">â‡µ</button>';
            div.appendChild(tools);

            // Selection toggle (click on empty area)
            div.addEventListener("click", (ev) => {
              if (ev.target instanceof HTMLButtonElement) return; // buttons handled below
              if (selected.has(i)) {
                selected.delete(i);
                div.classList.remove("active");
              } else {
                selected.add(i);
                div.classList.add("active");
              }
              enableActions();
              clearOutput();
            });
            tools.addEventListener("click", (ev) => {
              const btn = ev.target;
              if (!(btn instanceof HTMLButtonElement)) return;
              ev.stopPropagation();
              if (btn.dataset.act === "l") applyLocalRotation(i, -90);
              else if (btn.dataset.act === "r") applyLocalRotation(i, 90);
              else if (btn.dataset.act === "u") applyLocalRotation(i, 180);
            });

            pagesWrap.appendChild(div);
            thumbCanvases[i] = canvas;

            // Render this page thumbnail
            const page = await pdf.getPage(i + 1);
            const vp = page.getViewport({ scale: 1 });
            const targetW = 100; // px
            const scale = Math.max(0.15, Math.min(1.5, targetW / vp.width));
            const vps = page.getViewport({ scale });
            canvas.width = Math.floor(vps.width);
            canvas.height = Math.floor(vps.height);
            await page.render({
              canvasContext: canvas.getContext("2d"),
              viewport: vps,
            }).promise;
          }
          statusText.textContent =
            "Loaded " +
            pageCount +
            " page(s). Select pages or use per-page buttons to rotate.";
        } catch (e) {
          console.error(e);
          statusText.textContent = "Failed to read PDF.";
        }
      }

      function getOutputName(defaultBase) {
        const el = document.getElementById("output-name");
        let name =
          (el && el.value ? el.value : "").trim() || defaultBase || "output";
        name = name.replace(/[\\/:*?"<>|]/g, "-");
        if (!/\.pdf$/i.test(name)) name += ".pdf";
        return name;
      }

      function applyLocalRotation(index, deg) {
        if (!loadedDoc) return;
        rotations[index] = ((rotations[index] || 0) + deg + 360) % 360;
        const cnv = thumbCanvases[index];
        if (cnv) {
          cnv.style.transform = `rotate(${rotations[index]}deg)`;
        }
        statusText.textContent = `Page ${index + 1} rotated by ${Math.abs(
          deg
        )}Â° ${deg < 0 ? "left" : "right"}.`;
        downloadBtn.style.display = "inline-block";
      }

      function applyRotationToSelected(deg) {
        if (!loadedDoc) return;
        // If no pages selected, apply rotation to ALL pages for better UX
        let targets = selected.size
          ? Array.from(selected)
          : Array.from({ length: loadedDoc.getPageCount() }, (_, i) => i);
        targets.forEach((i) => applyLocalRotation(i, deg));
        const count = targets.length;
        statusText.textContent = `Rotated ${count} page(s) by ${Math.abs(
          deg
        )}Â° ${deg < 0 ? "left" : "right"}.`;
      }

      // Click on thumbnail itself rotates 90Â° right for quick action
      pagesWrap.addEventListener("dblclick", (e) => {
        const div = e.target.closest && e.target.closest(".page-thumb");
        if (!div) return;
        const i = parseInt(div.dataset.index, 10);
        if (Number.isInteger(i)) applyLocalRotation(i, 90);
      });

      rotateLeftBtn.addEventListener("click", () =>
        applyRotationToSelected(-90)
      );
      rotateRightBtn.addEventListener("click", () =>
        applyRotationToSelected(90)
      );
      rotate180Btn.addEventListener("click", () =>
        applyRotationToSelected(180)
      );
      downloadBtn.addEventListener("click", async () => {
        if (!loadedDoc) return;
        statusText.textContent = "Building rotated PDF...";
        try {
          const outDoc = await PDFLib.PDFDocument.create();
          const total = loadedDoc.getPageCount();
          const pages = await outDoc.copyPages(
            loadedDoc,
            Array.from({ length: total }, (_, i) => i)
          );
          pages.forEach((p, i) => {
            const base = p.getRotation().angle || 0;
            const add = rotations[i] || 0;
            p.setRotation(PDFLib.degrees((base + add) % 360));
            outDoc.addPage(p);
          });
          const outBytes = await outDoc.save();
          outBlob = new Blob([outBytes], { type: "application/pdf" });
          const url = URL.createObjectURL(outBlob);
          const a = document.createElement("a");
          a.href = url;
          a.download = getOutputName("rotated");
          a.click();
          URL.revokeObjectURL(url);
          statusText.textContent = "Downloaded rotated PDF successfully.";
        } catch (e) {
          console.error(e);
          statusText.textContent = "Failed to build rotated PDF.";
        }
      });

      // "Try it now" link functionality
      document.addEventListener("DOMContentLoaded", function () {
        const tryLinks = document.querySelectorAll('a[href="#file-input"]');
        tryLinks.forEach((link) => {
          link.addEventListener("click", function (e) {
            e.preventDefault();
            const fileInput = document.getElementById("file-input");
            if (fileInput) {
              fileInput.click();
              setTimeout(() => {
                window.scrollTo({ top: 0, behavior: "smooth" });
              }, 100);
            }
          });
        });
      });
    </script>
    <script src="../assets/app.js"></script>
  </body>
</html>
